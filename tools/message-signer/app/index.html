<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Message Signer â€” Web3Edu</title>

    <!-- Web3Edu shared theme -->
    <link rel="stylesheet" href="../../shared/web3edu-theme.css" />
    <link rel="stylesheet" href="style.css" />

    <!-- Crypto libs (same stack as Lab 02) -->
    <script src="vendor/sha3.min.js"></script>
    <script>
        // js-sha3 exposes either keccak256 or sha3_256 depending on build
        if (!window.keccak256 && window.sha3_256) {
            window.keccak256 = window.sha3_256;
        }
    </script>
    <script type="module">
        import * as secp256k1 from "./vendor/secp256k1.bundle.mjs";
        import { sha256 } from "./vendor/sha256.bundle.mjs";
        import { hmac } from "./vendor/hmac.bundle.mjs";

        // Provide sync hash/HMAC to avoid WebCrypto requirements.
        secp256k1.utils.sha256Sync = (msg) => sha256(msg);
        secp256k1.utils.hmacSha256Sync = (key, ...msgs) =>
            hmac(sha256, key, secp256k1.utils.concatBytes(...msgs));

        window.nobleSecp256k1 = secp256k1;
    </script>
</head>

<body>
    <main class="w3e-container">

        <h1 class="w3e-title">âœï¸ Message Signer</h1>
        <p class="w3e-subtitle">
            Sign a message using a private key to prove authorship and intent.
        </p>

        <!-- Explanation -->
        <section class="w3e-card w3e-card--explain">
            <p>
                This tool demonstrates <strong>raw cryptographic signing</strong>.
            </p>
            <ul>
                <li>The message remains readable</li>
                <li>The private key proves who signed it</li>
                <li>Anyone can verify the signature</li>
            </ul>
            <p class="w3e-hint">
                ğŸ’¡ You can reuse a <strong>private key generated in Lab 02</strong>.
            </p>
            <p class="w3e-hint">
                ğŸ’¡ As you type the message and private key, the signature updates live. Make sure to enter valid inputs.
            </p>
        </section>

        <!-- Input -->
        <section class="w3e-section w3e-controls">

            <label>
                Message to sign
                <textarea id="messageInput" rows="4" placeholder="Type any message you want to sign"></textarea>
                <p class="w3e-hint">
                    âœï¸ Try changing one character and observe how the signature changes.
                </p>
            </label>

            <label>
                Private Key (hex)
                <input id="privateKeyInput" placeholder="0xabc123... (from Lab 02)" />
            </label>

        </section>

        <!-- Output -->
        <section id="resultBox" class="w3e-card hidden">
            <h3>Signature Result</h3>
            <p class="w3e-hint">
                ğŸ” These values are produced <strong>offâ€‘chain</strong>. No blockchain interaction is required to sign
                or verify a message.
            </p>

            <div class="w3e-section">
                <label>Message Hash (keccak256)</label>
                <textarea id="hashOutput" class="mono placeholder" rows="2" readonly></textarea>
            </div>

            <div class="w3e-section">
                <label>Signature</label>
                <textarea id="signatureOutput" class="mono placeholder" rows="3" readonly></textarea>
            </div>

            <div class="w3e-controls w3e-controls--center">
                <button id="copyAllBtn" class="w3e-button secondary">
                    Copy All
                </button>
            </div>
        </section>

    </main>

    <script src="main.js"></script>
</body>

</html>